<div class="dialog-wrapper">
  <h2 mat-dialog-title>Add Task</h2>
  <div class="flex-wrapper">
    <mat-dialog-content>
      <form [formGroup]="myForm" class="form">
        <div class="input-wrapper">
          <mat-form-field appearance="fill">
            <mat-label>Task Name</mat-label>
            <input matInput class="input-item" [formControlName]="formControls.name" placeholder="Enter task name">
          </mat-form-field>
          <div *ngIf="isControlValid(formControls.name)" class="validate-hint">
            Please provide a name.
          </div>
        </div>
        <div class="input-wrapper">
          <mat-form-field appearance="fill">
            <mat-label>Task Priority</mat-label>
            <mat-select [formControlName]="formControls.priority">
              <mat-option *ngFor="let priority of priorities" [value]="priority"
                          [formControlName]="formControls.priority">
                {{priority}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div *ngIf="isControlValid(formControls.priority)" class="validate-hint">
            Please provide a priority.
          </div>
        </div>
        <div class="input-wrapper-picker">
          <mat-form-field appearance="fill">
            <mat-label>Choose a due date</mat-label>
            <input [formControlName]="formControls.dueDate" [min]="newDate" matInput [matDatepicker]="picker">
            <mat-hint>MM/DD/YYYY</mat-hint>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
          <div *ngIf="isControlValid(formControls.dueDate)" class="validate-hint">
            Please provide a due date.
          </div>
        </div>
        <div class="input-wrapper">
          <mat-form-field appearance="fill">
            <mat-label>Task Groups</mat-label>
            <mat-select [formControlName]="formControls.group">
              <mat-option *ngFor="let group of filteredGroups" [value]="group.name">
                {{group.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div *ngIf="isControlValid(formControls.group)" class="validate-hint">
            Please provide a group.
          </div>
        </div>
        <div class="input-wrapper">
          <mat-form-field appearance="fill">
            <mat-label>Assigned User</mat-label>
            <mat-select [formControlName]="formControls.assignedUser">
              <mat-option *ngFor="let user of (users$ | async)" [value]="user.name">{{user.name}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="input-wrapper">
          <mat-form-field appearance="fill">
            <mat-label>Task Description</mat-label>
            <textarea matInput placeholder="Enter task description"
                      [formControlName]="formControls.description"></textarea>
          </mat-form-field>
          <div *ngIf="isControlValid(formControls.description)" class="validate-hint">
            Please provide a description.
          </div>
        </div>
      </form>
      <div class="file-wrapper">
        <div class="img-wrapper">
          <img *ngIf="imageLink" [src]="imageLink" width="150" height="100"/>
        </div>
        <div class="upload-wrapper" [style.display]="imageLink ? 'none' : 'flex'">
          <div (click)="uploadFile.click()">
            <button mat-button color="primary">Choose File</button>
            <input #uploadFile (change)="onFileSelected($event)" type='file' style="display:none" autocomplete="off"/>
          </div>
          <div>
            <progress max="100" [value]="progress"></progress>
          </div>
        </div>
      </div>
    </mat-dialog-content>
  </div>
  <mat-dialog-actions class="actions">
    <button mat-raised-button mat-dialog-close color="warn">Cancel</button>
    <button mat-raised-button [mat-dialog-close]="true" color="primary" cdkFocusInitial [disabled]="myForm.invalid"
            (click)="submitForm()">Save
    </button>
  </mat-dialog-actions>
</div>
